@startuml
actor ユーザー

note right of ユーザー
  ユーザーがフォームに入力する
end note

activate ユーザー

ユーザー -> フォームコントローラ: フォームを送信
activate フォームコントローラ

alt ドキュメントにエラーがある
  フォームコントローラ --> フォームビュー: エラーを表示
  activate フォームビュー

  フォームビュー -> ユーザー: エラーを表示
  deactivate フォームビュー
else
  フォームコントローラ --> ドキュメントコントローラ: ドキュメントを保存
  activate ドキュメントコントローラ

  alt ドキュメントの検証が成功
    ドキュメントコントローラ -> データベース: ドキュメントデータを保存
    データベース --> ドキュメントコントローラ: 確認
    ドキュメントコントローラ -> フォームビュー: 成功メッセージを表示
    activate フォームビュー
    フォームビュー --> ユーザー: 成功メッセージを表示
    deactivate フォームビュー
  else ドキュメントの検証が失敗
    ドキュメントコントローラ -> フォームビュー: 検証エラーを表示
    activate フォームビュー
    フォームビュー --> ユーザー: 検証エラーを表示
    deactivate フォームビュー
  end
  deactivate ドキュメントコントローラ
end

deactivate フォームコントローラ
deactivate ユーザー
@enduml
